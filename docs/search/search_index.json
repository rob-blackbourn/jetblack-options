{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Home","text":"<p>This repository contains reference implementations of option pricing formulae implemented in Python.</p> <p>It has no dependencies.</p> <p>There is a web UI demonstrating some of the valuations here.</p>"},{"location":"#status","title":"Status","text":"<p>This is currently considered alpha.</p>"},{"location":"#usage","title":"Usage","text":"<p>The library can be installed as a package.</p> <pre><code>pip install jetblack-options\n</code></pre> <p>An obvious place to start would be with Black-Scholes.</p> <pre><code>from jetblack_options.european.black_scholes_merton import (\n    price,\n    delta\n)\n\nis_call = True\nS = 110 # Asset price.\nK = 100 # Strike price.\nr = 0.1 # 10% risk free rate.\nq = 0.08 # 8% dividend.\nT = 6/12 # Half a year till expiry.\nv = 0.125 # 12.5% volatility.\n\nb = r - q # Cost of carry for generalized Black-Scholes.\n\np = price(is_call, S, K, T, r, b, v)\nd = delta(is_call, S, K, T, r, b, v)\n\n# Calculate the delta by bumping the price.\nfrom jetblack_options.numeric_greeks.with_carry import NumericGreeks\nng = NumericGreeks(price)\nd1 = ng.delta(is_call, S, K, T, r, b, v)\n</code></pre> <p>Typically each module has a function called <code>price</code> which calculates the price of the model. Where closed form solutions are available, they have their canonical name (e.g. <code>delta</code>). In this case a general numeric class was also available.</p> <p>A tree solution only provides a price. However the numeric class can provide support for the greeks.</p> <pre><code>from jetblack_options.trees.cox_ross_rubinstein import greeks\nfrom jetblack_options.numeric_greeks import NumericGreeks\n\nis_european = True\nis_call = True\nS = 110 # Stock price.\nK = 100 # Strike price.\nr = 0.1 # 10% risk free rate.\nq = 0.08 # 8% dividend.\nT = 6/12 # Half a year till expiry.\nv = 0.125 # 12,5% volatility.\n\nb = r - q\nvalue, delta, gamma, theta = greeks(is_european, is_call, S, K, T, r, b, v, 200)\n\n# Make a lambda to handle is_european.\nng = NumericGreeks(\n    lambda is_call, S, K, T, r, b, v: greeks(is_european, is_call, S, K, T, r, b, v, 100)[0]\n)\n# The numeric delta should be close to the analytic.\nnumeric_delta = ng.delta(is_call, S, K, T, r, b, v)\n</code></pre>"},{"location":"#pandas","title":"Pandas","text":"<p>The code has been written without dependencies to keep the implementation clean.</p> <p>It is fairly simple to support vectors. The following is the generalised Black Scholes price function using scipy, numpy and pandas.</p> <pre><code>import numpy as np\nimport pandas as pd\nfrom scipy.stats import norm\n\ndef price(is_call, S, K, T, r, b, v):\n    d1 = (np.log(S / K) + T * (b + v ** 2 / 2)) / (v * np.sqrt(T))\n    d2 = d1 - v * np.sqrt(T)\n\n    if is_call:\n        return S * np.exp((b - r) * T) * norm.cdf(d1) - K * np.exp(-r * T) * norm.cdf(d2)\n    else:\n        return K * np.exp(-r * T) * norm.cdf(-d2) - S * np.exp((b - r) * T) * norm.cdf(-d1)\n\ndf = pd.DataFrame([\n    {'S': 110, 'K': 100, 'r': 0.1, 'q': 0.08, 'T': 6/12, 'v': 0.125},\n    {'S': 100, 'K': 100, 'r': 0.1, 'q': 0.08, 'T': 6/12, 'v': 0.125},\n    {'S': 100, 'K': 110, 'r': 0.1, 'q': 0.08, 'T': 6/12, 'v': 0.125},\n])\n\nprice(True, df['S'], df['K'], df['T'], df['r'], df['r'] - df['q'], df['v'])\n</code></pre> <p>Here's another implementation using a single data frame.</p> <pre><code>import numpy as np\nimport pandas as pd\nfrom scipy.stats import norm\n\ndata = pd.DataFrame([\n    {'is_call': True, 'S': 110, 'K': 100, 'r': 0.1, 'q': 0.08, 'T': 6/12, 'v': 0.125},\n    {'is_call': False, 'S': 110, 'K': 100, 'r': 0.1, 'q': 0.08, 'T': 6/12, 'v': 0.125},\n    {'is_call': True, 'S': 100, 'K': 100, 'r': 0.1, 'q': 0.08, 'T': 6/12, 'v': 0.125},\n    {'is_call': False, 'S': 100, 'K': 100, 'r': 0.1, 'q': 0.08, 'T': 6/12, 'v': 0.125},\n    {'is_call': True, 'S': 100, 'K': 110, 'r': 0.1, 'q': 0.08, 'T': 6/12, 'v': 0.125},\n    {'is_call': False, 'S': 100, 'K': 110, 'r': 0.1, 'q': 0.08, 'T': 6/12, 'v': 0.125},\n])\n\ndef price(df):\n    d1 = (np.log(df['S'] / df['K']) + df['T'] * (df['b'] + df['v'] ** 2 / 2)) / (df['v'] * np.sqrt(df['T']))\n    d2 = d1 - df['v'] * np.sqrt(df['T'])\n\n    return pd.Series(np.where(\n        df['is_call'],\n        df['S'] * np.exp((df['b'] - df['r']) * df['T']) * norm.cdf(d1) - df['K'] * np.exp(-df['r'] * df['T']) * norm.cdf(d2),\n        df['K'] * np.exp(-df['r'] * df['T']) * norm.cdf(-d2) - df['S'] * np.exp((df['b'] - df['r']) * df['T']) * norm.cdf(-d1)\n    ), name='price')\n\ndata['b'] = data['r'] - data['q']\nx = price(data)\n</code></pre>"},{"location":"api/jetblack_options.american/","title":"jetblack_options.american","text":""},{"location":"api/jetblack_options.american/#module-jetblack_optionsamericanbarone_adesi_whaley","title":"module jetblack_options.american.barone_adesi_whaley","text":""},{"location":"api/jetblack_options.american/#summary","title":"Summary","text":"<p>Barone-Adesi and Whaley</p>"},{"location":"api/jetblack_options.american/#function-jetblack_optionsamericanbarone_adesi_whaleymake_bumper","title":"function jetblack_options.american.barone_adesi_whaley.make_bumper","text":""},{"location":"api/jetblack_options.american/#summary_1","title":"Summary","text":"<p>Make a class to generate greeks using finite difference methods.</p> jetblack_options.american.barone_adesi_whaley.make_bumper( is_call: bool ) -&gt; NumericGreeks"},{"location":"api/jetblack_options.american/#parameters","title":"Parameters","text":"is_call: bool <p>If true the options is a call.</p>"},{"location":"api/jetblack_options.american/#returns","title":"Returns","text":"NumericGreeks:  A class which can generate Greeks by bumping."},{"location":"api/jetblack_options.american/#function-jetblack_optionsamericanbarone_adesi_whaleyprice","title":"function jetblack_options.american.barone_adesi_whaley.price","text":""},{"location":"api/jetblack_options.american/#summary_2","title":"Summary","text":"<p>The Barone-Adesi and Whaley (1987) American approximation.</p> jetblack_options.american.barone_adesi_whaley.price( is_call: bool, S: float, K: float, T: float, r: float, b: float, v: float ) -&gt; float"},{"location":"api/jetblack_options.american/#parameters_1","title":"Parameters","text":"is_call: bool <p>True for a call, false for a put.</p> S: float <p>The asset price.</p> K: float <p>The strike price.</p> T: float <p>The time to expiry in years.</p> r: float <p>The risk free rate.</p> b: float <p>The cost of carry.</p> v: float <p>The asset volatility.</p>"},{"location":"api/jetblack_options.american/#returns_1","title":"Returns","text":"float:  The price of the option."},{"location":"api/jetblack_options.european/","title":"jetblack_options.european","text":""},{"location":"api/jetblack_options.european/#module-jetblack_optionseuropeanblack_76","title":"module jetblack_options.european.black_76","text":""},{"location":"api/jetblack_options.european/#summary","title":"Summary","text":"<p>Black (1976) Options on futures/forwards</p>"},{"location":"api/jetblack_options.european/#description","title":"Description","text":"<ul> <li>The discounted futures price F,</li> <li>Strike price K,</li> <li>Risk-free rate r,</li> <li>Annual dividend yield q,</li> <li>Time to maturity \u03c4=T\u2212t </li> <li>Volatility \u03c3.</li> </ul> <p>Most of the formula use one or both of the following terms.</p> d1=ln(F/K)+(\u03c32/2)T\u03c3T d2=ln(F/K)\u2212(\u03c32/2)T\u03c3T=d1\u2212\u03c3T \u03c6(x)&amp;=12\u03c0e\u221212x2 \u03a6(x)&amp;=12\u03c0\u222b\u2212\u221exe\u221212y2dy=1\u221212\u03c0\u222bx\u221ee\u221212y2dy"},{"location":"api/jetblack_options.european/#function-jetblack_optionseuropeanblack_76delta","title":"function jetblack_options.european.black_76.delta","text":""},{"location":"api/jetblack_options.european/#summary_1","title":"Summary","text":"<p>The sensitivity of the option to a change in the asset price</p> jetblack_options.european.black_76.delta( is_call: bool, F: float, K: float, T: float, r: float, v: float ) -&gt; float"},{"location":"api/jetblack_options.european/#description_1","title":"Description","text":"<p>using Black 76.</p> <p>Call \u0394: e\u2212r\u03c4\u03a6(d1) </p> <p>Put \u0394: \u2212e\u2212r\u03c4\u03a6(\u2212d1) </p>"},{"location":"api/jetblack_options.european/#parameters","title":"Parameters","text":"is_call: bool <p>True for a call, false for a put.</p> F: float <p>The current futures price.</p> K: float <p>The strike price.</p> T: float <p>The time to expiry in years.</p> r: float <p>The risk free rate.</p> v: float <p>The volatility.</p>"},{"location":"api/jetblack_options.european/#returns","title":"Returns","text":"float:  The delta."},{"location":"api/jetblack_options.european/#function-jetblack_optionseuropeanblack_76gamma","title":"function jetblack_options.european.black_76.gamma","text":""},{"location":"api/jetblack_options.european/#summary_2","title":"Summary","text":"<p>The second derivative to the change in asset price using Black 76.</p> jetblack_options.european.black_76.gamma( F: float, K: float, T: float, r: float, v: float ) -&gt; float"},{"location":"api/jetblack_options.european/#description_2","title":"Description","text":"e\u2212r\u03c4\u03c6(d1)F\u03c3\u03c4=Ke\u2212r\u03c4\u03c6(d2)F2\u03c3\u03c4"},{"location":"api/jetblack_options.european/#parameters_1","title":"Parameters","text":"F: float <p>The current futures price.</p> K: float <p>The strike price.</p> T: float <p>The time to expiry in years.</p> r: float <p>The risk free rate.</p> v: float <p>The volatility.</p>"},{"location":"api/jetblack_options.european/#returns_1","title":"Returns","text":"float:  The gamma."},{"location":"api/jetblack_options.european/#function-jetblack_optionseuropeanblack_76ivol","title":"function jetblack_options.european.black_76.ivol","text":""},{"location":"api/jetblack_options.european/#summary_3","title":"Summary","text":"<p>Calculate the volatility of a Black 76 option that is implied by the price.</p> jetblack_options.european.black_76.ivol( is_call: bool, F: float, K: float, T: float, r: float, p: float, *, max_iterations: int, Optional, epsilon: float, Optional ) -&gt; float"},{"location":"api/jetblack_options.european/#parameters_2","title":"Parameters","text":"is_call: bool <p>True for a call, false for a put.</p> F: float <p>The current asset price.</p> K: float <p>The option strike price</p> T: float <p>The time to maturity of the option in years.</p> r: float <p>The risk free rate.</p> p: float <p>The option price.</p> max_iterations: int, Optional <p>The maximum number of iterations before a price is returned. Defaults to 20.</p> epsilon: float, Optional (optional) <p>The largest acceptable error. Defaults to 1e-8.</p>"},{"location":"api/jetblack_options.european/#returns_2","title":"Returns","text":"float:  The implied volatility."},{"location":"api/jetblack_options.european/#function-jetblack_optionseuropeanblack_76make_bumper","title":"function jetblack_options.european.black_76.make_bumper","text":"jetblack_options.european.black_76.make_bumper( is_call: bool ) -&gt; NumericGreeks"},{"location":"api/jetblack_options.european/#parameters_3","title":"Parameters","text":"is_call: bool"},{"location":"api/jetblack_options.european/#returns_3","title":"Returns","text":"NumericGreeks:"},{"location":"api/jetblack_options.european/#function-jetblack_optionseuropeanblack_76price","title":"function jetblack_options.european.black_76.price","text":""},{"location":"api/jetblack_options.european/#summary_4","title":"Summary","text":"<p>Fair value of a futures/forward using Black 76.</p> jetblack_options.european.black_76.price( is_call: bool, F: float, K: float, T: float, r: float, v: float ) -&gt; float"},{"location":"api/jetblack_options.european/#description_3","title":"Description","text":"<p>Call price: e\u2212r\u03c4[F\u03a6(d1)\u2212K\u03a6(d2)] </p> <p>Put price: e\u2212r\u03c4[K\u03a6(\u2212d2)\u2212F\u03a6(\u2212d1)] </p>"},{"location":"api/jetblack_options.european/#parameters_4","title":"Parameters","text":"is_call: bool <p>True for a call, false for a put.</p> F: float <p>The price of the future.</p> K: float <p>The strike price.</p> T: float <p>The time to expiry in years.</p> r: float <p>The risk free rate.</p> v: float <p>The asset volatility.</p>"},{"location":"api/jetblack_options.european/#returns_4","title":"Returns","text":"float:  The option price."},{"location":"api/jetblack_options.european/#function-jetblack_optionseuropeanblack_76rho","title":"function jetblack_options.european.black_76.rho","text":""},{"location":"api/jetblack_options.european/#summary_5","title":"Summary","text":"<p>The sensitivity of the option price to a change in the risk free rate</p> jetblack_options.european.black_76.rho( is_call: bool, F: float, K: float, T: float, r: float, v: float ) -&gt; float"},{"location":"api/jetblack_options.european/#description_4","title":"Description","text":"<p>using Black 76.</p> <p>Call \u03c1=\u2212\u03c4e\u2212r\u03c4[F\u03a6(d1)\u2212K\u03a6(d2)] </p> <p>Put \u03c1=\u2212\u03c4e\u2212r\u03c4[K\u03a6(\u2212d2)\u2212F\u03a6(\u2212d1)] </p>"},{"location":"api/jetblack_options.european/#parameters_5","title":"Parameters","text":"is_call: bool <p>True for a call, false for a put.</p> F: float <p>The price of the future.</p> K: float <p>The strike price.</p> T: float <p>The time to expiry in years.</p> r: float <p>The risk free rate.</p> v: float <p>The asset volatility.</p>"},{"location":"api/jetblack_options.european/#returns_5","title":"Returns","text":"float:  The rho."},{"location":"api/jetblack_options.european/#function-jetblack_optionseuropeanblack_76theta","title":"function jetblack_options.european.black_76.theta","text":""},{"location":"api/jetblack_options.european/#summary_6","title":"Summary","text":"<p>The change in the value of the option with respect to time to expiry</p> jetblack_options.european.black_76.theta( is_call: bool, F: float, K: float, T: float, r: float, v: float ) -&gt; float"},{"location":"api/jetblack_options.european/#description_5","title":"Description","text":"<p>using Black 76.</p> \u2212Fe\u2212r\u03c4\u03c6(d1)\u03c32\u03c4\u2212rKe\u2212r\u03c4\u03a6(d2)+rFe\u2212r\u03c4\u03a6(d1) \u2212Fe\u2212r\u03c4\u03c6(d1)\u03c32\u03c4+rKe\u2212r\u03c4\u03a6(\u2212d2)\u2212rFe\u2212r\u03c4\u03a6(\u2212d1)"},{"location":"api/jetblack_options.european/#parameters_6","title":"Parameters","text":"is_call: bool <p>True for a call, false for a put.</p> F: float <p>The current futures price.</p> K: float <p>The strike price.</p> T: float <p>The time to expiry in years.</p> r: float <p>The risk free rate.</p> v: float <p>The volatility.</p>"},{"location":"api/jetblack_options.european/#returns_6","title":"Returns","text":"float:  The theta."},{"location":"api/jetblack_options.european/#function-jetblack_optionseuropeanblack_76vanna","title":"function jetblack_options.european.black_76.vanna","text":""},{"location":"api/jetblack_options.european/#summary_7","title":"Summary","text":"<p>The sensitivity of the option value to the underlying</p> jetblack_options.european.black_76.vanna( F: float, K: float, T: float, r: float, v: float ) -&gt; float"},{"location":"api/jetblack_options.european/#description_6","title":"Description","text":"<p>asset price and the volatility.</p> \u22022V\u2202F\u2202\u03c3=\u2212e\u2212r\u03c4\u03c6(d1)d2\u03c3=\ud835\udcb1F[1\u2212d1\u03c3\u03c4]"},{"location":"api/jetblack_options.european/#parameters_7","title":"Parameters","text":"F: float <p>The price of the future.</p> K: float <p>The strike price.</p> T: float <p>The time to expiry in years.</p> r: float <p>The risk free rate.</p> v: float <p>The asset volatility.</p>"},{"location":"api/jetblack_options.european/#returns_7","title":"Returns","text":"float:  The vanna."},{"location":"api/jetblack_options.european/#function-jetblack_optionseuropeanblack_76vega","title":"function jetblack_options.european.black_76.vega","text":""},{"location":"api/jetblack_options.european/#summary_8","title":"Summary","text":"<p>The sensitivity of the options price or a change in the asset volatility</p> jetblack_options.european.black_76.vega( F: float, K: float, T: float, r: float, v: float ) -&gt; float"},{"location":"api/jetblack_options.european/#description_7","title":"Description","text":"<p>using Black 76.</p> Fe\u2212r\u03c4\u03c6(d1)\u03c4=Ke\u2212r\u03c4\u03c6(d2)\u03c4"},{"location":"api/jetblack_options.european/#parameters_8","title":"Parameters","text":"F: float <p>The current futures price.</p> K: float <p>The strike price.</p> T: float <p>The time to expiry in years.</p> r: float <p>The risk free rate.</p> v: float <p>The volatility.</p>"},{"location":"api/jetblack_options.european/#returns_8","title":"Returns","text":"float:  The vega."},{"location":"api/jetblack_options.european/#function-jetblack_optionseuropeanblack_76vomma","title":"function jetblack_options.european.black_76.vomma","text":""},{"location":"api/jetblack_options.european/#summary_9","title":"Summary","text":"<p>The second order sensitivity to volatility.</p> jetblack_options.european.black_76.vomma( F: float, K: float, T: float, r: float, v: float ) -&gt; float"},{"location":"api/jetblack_options.european/#description_8","title":"Description","text":"Fe\u2212r\u03c4\u03c6(d1)\u03c4d1d2\u03c3=\ud835\udcb1d1d2\u03c3"},{"location":"api/jetblack_options.european/#parameters_9","title":"Parameters","text":"F: float <p>The price of the future.</p> K: float <p>The strike price.</p> T: float <p>The time to expiry in years.</p> r: float <p>The risk free rate.</p> v: float <p>The asset volatility.</p>"},{"location":"api/jetblack_options.european/#returns_9","title":"Returns","text":"float:  The vomma"},{"location":"api/jetblack_options.trees/","title":"jetblack_options.trees","text":""},{"location":"api/jetblack_options.trees/#module-jetblack_optionstrees","title":"module jetblack_options.trees","text":""}]}